<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Roue Sport Santé - Hérault</title>
    <style>
        :root {
            --magenta: #e2007a;
            --bleu-herault: #0055a4;
            --gris-clair: #f4f4f4;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: var(--gris-clair);
            margin: 0;
            padding: 10px;
            min-height: 100vh;
        }

        /* --- HEADER & LOGOS RESPONSIVE --- */
        .header-logos {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
        }

        .header-logos img {
            height: auto;
            max-width: 120px; /* Taille pour mobile */
        }

        /* --- CONTENEUR DE LA ROUE --- */
        #wheel-container {
            position: relative;
            width: 90vw; /* Utilise 90% de la largeur de l'écran */
            max-width: 450px; /* Mais pas plus de 450px */
            aspect-ratio: 1 / 1;
            margin: 20px 0;
        }

        canvas {
            width: 100% !important;
            height: 100% !important;
        }

        #pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid var(--magenta);
            z-index: 10;
        }

        /* --- BOUTONS & INTERFACE --- */
        #spin-btn {
            background-color: var(--magenta);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            margin-top: 10px;
        }

        #spin-btn:active {
            transform: scale(0.95);
        }

        /* --- ZONE DE RÉSULTAT --- */
        #result-card {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            max-width: 400px;
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 100;
        }

        #result-card h2 { color: var(--magenta); margin-top: 0; }
        #result-card p { font-size: 1.1rem; line-height: 1.5; }

        .overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 99;
        }

        /* --- ADAPTATIONS TABLETTE ET PC --- */
        @media (min-width: 768px) {
            .header-logos img { max-width: 180px; }
            #wheel-container { max-width: 500px; }
        }
    </style>
</head>
<body>

    <div class="header-logos">
        <img src="logo-herault.png" alt="Département de l'Hérault">
        <img src="logo-departement.png" alt="Hérault Sport">
    </div>

    <div id="wheel-container">
        <div id="pointer"></div>
        <canvas id="wheelCanvas" width="500" height="500"></canvas>
    </div>

    <button id="spin-btn">LANCER LA ROUE</button>

    <div class="overlay" id="overlay"></div>
    <div id="result-card">
        <h2 id="res-theme">Thème</h2>
        <p id="res-question">La question apparaîtra ici...</p>
        <button onclick="closeResult()" style="background:var(--bleu-herault); color:white; border:none; padding:10px 20px; border-radius:10px;">Continuer</button>
    </div>

    <script>
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spin-btn');
        const resultCard = document.getElementById('result-card');
        const overlay = document.getElementById('overlay');

        const themes = [
            { label: "ALIMENTATION", color: "#e2007a", q: "Question Alimentation en attente..." },
            { label: "SOMMEIL", color: "#0055a4", q: "Question Sommeil en attente..." },
            { label: "ÉCRANS", color: "#e2007a", q: "Question Écrans en attente..." },
            { label: "ACTIVITÉ PHYSIQUE", color: "#0055a4", q: "Question Sport en attente..." },
            { label: "HYGIÈNE", color: "#e2007a", q: "Question Hygiène en attente..." },
            { label: "BIEN-ÊTRE", color: "#0055a4", q: "Question Bien-être en attente..." }
        ];

        let currentRotation = 0;
        const sliceAngle = (2 * Math.PI) / themes.length;

        function drawWheel() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            themes.forEach((theme, i) => {
                const angle = i * sliceAngle + currentRotation;
                ctx.beginPath();
                ctx.fillStyle = theme.color;
                ctx.moveTo(250, 250);
                ctx.arc(250, 250, 240, angle, angle + sliceAngle);
                ctx.fill();
                ctx.stroke();

                // Texte
                ctx.save();
                ctx.translate(250, 250);
                ctx.rotate(angle + sliceAngle / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "white";
                ctx.font = "bold 16px Arial";
                ctx.fillText(theme.label, 220, 10);
                ctx.restore();
            });
        }

        function spin() {
            spinBtn.disabled = true;
            const extraSpins = 5 + Math.random() * 5;
            const totalRotation = extraSpins * 2 * Math.PI;
            
            const start = performance.now();
            const duration = 4000;

            function animate(now) {
                const elapsed = now - start;
                const progress = Math.min(elapsed / duration, 1);
                const easeOut = 1 - Math.pow(1 - progress, 3);
                
                currentRotation = (easeOut * totalRotation) % (2 * Math.PI);
                drawWheel();

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    determineResult();
                    spinBtn.disabled = false;
                }
            }
            requestAnimationFrame(animate);
        }

        function determineResult() {
            // Le pointeur est en haut (-90 degrés soit 1.5 * PI)
            const normalizedRotation = (1.5 * Math.PI - currentRotation) % (2 * Math.PI);
            const finalAngle = normalizedRotation < 0 ? normalizedRotation + 2 * Math.PI : normalizedRotation;
            const index = Math.floor(finalAngle / sliceAngle) % themes.length;
            
            const winner = themes[index];
            document.getElementById('res-theme').innerText = winner.label;
            document.getElementById('res-question').innerText = winner.q;
            resultCard.style.display = 'block';
            overlay.style.display = 'block';
        }

        function closeResult() {
            resultCard.style.display = 'none';
            overlay.style.display = 'none';
        }

        spinBtn.addEventListener('click', spin);
        drawWheel();
    </script>
</body>
</html>

